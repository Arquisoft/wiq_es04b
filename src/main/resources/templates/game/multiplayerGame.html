<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/head}"></head>
<body>
<link th:href="@{/css/game.css}" rel="stylesheet" type="text/css"/>
<canvas th:replace="~{fragments/background}"></canvas>
<nav th:replace="~{fragments/nav}"></nav>

<label class="form-label col-sm-10 text-center mb-3" for="code" th:text="#{multi.label}"></label>
<div class="form-group col-sm-8 mx-auto">
    <input type="text" class="form-control w-80 mx-auto" id="code" name="code"
           th:placeholder="#{multi.placeholder}" oninput="toggleJoinButton()"/>
    <!--<span class="text-danger" th:if="${#fields.hasErrors('code')}" th:errors="*{email}"></span>-->
    <p id="error-msg"  class="text-danger" style="display: none;" th:text="#{multi.onlyNumber}"></p>

</div>
<button id="joinBtn" type="submit" class="btn btn-primary btn-block mb-2" th:text="#{multi.join}" onclick="joinGame()" disabled></button>
<!--Hay q comprobar q el codigo exista y demÃ¡s
<span class="text-danger" th:if="${#fields.hasErrors('username')}" th:errors="*{username}"></span>-->

<p class="display-5 text-center">
    <span th:text="#{multi.text}"></span>
</p>
<a th:href="@{'/multiplayerGame/createGame'}">
    <button id="createBtn" type="button" class="btn btn-primary btn-block mb-2" th:text="#{multi.create}"></button>
</a>


<footer th:replace="~{fragments/footer}"></footer>

</body>
</html>

<script>
    function joinGame() {
        var code = document.getElementById("code").value;
        window.location.href = '/multiplayerGame/' + code;
    }

    function toggleJoinButton() {
        var codeInput = document.getElementById("code");
        var joinBtn = document.getElementById("joinBtn");

        var containsOnlyNumbers = /^[0-9]+$/.test(codeInput.value);

        if (containsOnlyNumbers) {
            joinBtn.disabled = false;
            document.getElementById("error-msg").style.display = "none";
        } else {
            joinBtn.disabled = true;
            document.getElementById("error-msg").style.display = "block";
        }
    }
</script>
